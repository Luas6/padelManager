<section id="registro-reservas">
    <div class="container mt-5">
        <h2>Formulario de Reserva</h2>
        <form (ngSubmit)="onSubmit()" [formGroup]="reservasForm">
            <div class="form-group py-2">
                <label for="fecha">Fecha:</label>
                <input type="date" class="form-control" id="fecha" name="fecha" formControlName="fecha" (change)="loadHorasDisponibles()">
                <div *ngIf="reservasForm.controls['fecha'].invalid && (reservasForm.controls['fecha'].dirty || reservasForm.controls['fecha'].touched)">
                    <div *ngIf="reservasForm.controls['fecha'].hasError('required')" class="error">
                        La fecha es obligatoria.
                    </div>
                </div>
            </div>

            <div class="form-group py-2">
                <label for="hora">Hora:</label>
                <select class="form-control" id="hora" name="hora" formControlName="hora" (change)="loadPistasDisponibles()" [disabled]="!reservasForm.get('fecha')?.value">
                    <option value="" disabled selected>Selecciona una hora</option>
                    <option value="09:00" [disabled]="!horasDisponibles.includes('09:00')">09:00 - 10:30</option>
                    <option value="10:30" [disabled]="!horasDisponibles.includes('10:30')">10:30 - 12:00</option>
                    <option value="12:00" [disabled]="!horasDisponibles.includes('12:00')">12:00 - 13:30</option>
                    <option value="" disabled>Descanso</option>
                    <option value="16:30" [disabled]="!horasDisponibles.includes('16:30')">16:30 - 18:00</option>
                    <option value="18:00" [disabled]="!horasDisponibles.includes('18:00')">18:00 - 19:30</option>
                    <option value="19:30" [disabled]="!horasDisponibles.includes('19:30')">19:30 - 21:00</option>
                    <option value="21:00" [disabled]="!horasDisponibles.includes('21:00')">21:00 - 22:30</option>
                </select>
                <div *ngIf="reservasForm.controls['hora'].invalid && (reservasForm.controls['hora'].dirty || reservasForm.controls['hora'].touched)">
                    <div *ngIf="reservasForm.controls['hora'].hasError('required')" class="error">
                        La hora es obligatoria.
                    </div>
                </div>
            </div>

            <div class="form-group py-2">
                <label for="pista">Pista:</label>
                <select class="form-control" id="pista" name="pista" formControlName="pista" [disabled]="!reservasForm.get('hora')?.value">
                    <option value="" disabled selected>Selecciona una pista</option>
                    <option value="1" [disabled]="!pistasDisponibles.includes(1)">1</option>
                    <option value="2" [disabled]="!pistasDisponibles.includes(2)">2</option>
                    <option value="3" [disabled]="!pistasDisponibles.includes(3)">3</option>
                    <option value="4" [disabled]="!pistasDisponibles.includes(4)">4</option>
                </select>
                <div *ngIf="reservasForm.controls['pista'].invalid && (reservasForm.controls['pista'].dirty || reservasForm.controls['pista'].touched)">
                    <div *ngIf="reservasForm.controls['pista'].hasError('required')" class="error">
                        La pista es obligatoria.
                    </div>
                </div>
            </div>
            <div *ngIf="errorMensaje" class="alert alert-danger py-2">
                {{ errorMensaje }}
            </div>
            <button type="submit" class="btn btn-primary py-2">Reservar</button>
        </form>
    </div>
</section>

<ng-template #exitoModal let-modal>
    <div class="modal-header">
      <h4 class="modal-title">Reservado</h4>
    </div>
    <div class="modal-body">
      <p>Su reserva ha sido procesada con Ã©xito.
        Te esperamos en nuestras instalaciones.
      </p>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-success" (click)="close()">Cerrar</button>
    </div>
  </ng-template>